"0","#########################"
"0","######## 2013 data ######"
"0","########################"
"0","## subsetting only the DHPS SNPs "
"0","dhps_sub <- subset(mipfull2, mipfull2$POS ==549685 | mipfull2$POS == 550117 | mipfull2$POS == 549993 | mipfull2$POS == 403625)"
"0","dhps_gt <- dhps_sub[c(1,5,52,54)]"
"0","## "
"0","#dhps_nomiss <- as.data.frame(subset(dhps_gt, !is.na(dhps_gt$`Binary Genotype Call`)))"
"0","dhps_nomiss <- as.data.frame(dhps_gt)"
"0","A437G <- subset(dhps_nomiss, dhps_nomiss$POS == 549685)"
"0","A437G$A437G[A437G$`Binary Genotype Call` == ""MUT""] <-1"
"0","A437G$A437G[A437G$`Binary Genotype Call` == ""WT""] <-0"
"0","K540E <- as.data.frame(subset(dhps_nomiss, dhps_nomiss$POS == 549993))"
"0","K540E$K540E[K540E$`Binary Genotype Call` == ""MUT""] <-1"
"0","K540E$K540E[K540E$`Binary Genotype Call` == ""WT""] <-0"
"0","A581G <- as.data.frame(subset(dhps_nomiss, dhps_nomiss$POS == 550117))"
"0","A581G$A581G[A581G$`Binary Genotype Call` == ""MUT""] <-1"
"0","A581G$A581G[A581G$`Binary Genotype Call` == ""WT""] <-0"
"0","CRT <- as.data.frame(subset(dhps_nomiss, dhps_nomiss$POS == 403625))"
"0","CRT$CRT[CRT$`Binary Genotype Call` == ""MUT""] <-1"
"0","CRT$CRT[CRT$`Binary Genotype Call` == ""WT""] <-0"
"0","dhps_merged <- merge(A437G, K540E, by = ""Sample ID"")"
"0","dhps_merged <- merge(dhps_merged, A581G, by = ""Sample ID"")"
"0","## making a mixed infection variable "
"0","dhps_merged$mixed <- apply(dhps_merged, 1, function(x){as.numeric(any(x == ""MIX"", na.rm = T))}) #shit I love this function "
"0","## subsetting just the SNP calls "
"0","dhps_snps <- dhps_merged[c(""Sample ID"", ""A437G"", ""K540E"", ""A581G"", ""mixed"")]"
"0","dhps_snps <- merge(dhps_snps, CRT, by = ""Sample ID"")"
"0","dhps_snps <- dhps_snps[c(""Sample ID"", ""A437G"", ""K540E"", ""A581G"", ""mixed"", ""CRT"")]"
"0","## making  barcode variable"
"0","dhps_snps$Barcode <- sub(""-SM-1"", """", dhps_snps$`Sample ID`, fixed = T)"
"0","dhps_snps$Barcode <- str_sub(dhps_snps$Barcode, -5)"
"0","### need to drop the controls - merged kids 2013 data "
"0","dhps_snps <- merge(dhps_snps, DHSChildrenU5, by.x=""Barcode"", by.y = ""sh312"")"
